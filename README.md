# 音频调性检测器

一个基于Python的可视化音频调性检测工具，支持GUI界面，能精确分析音频文件的调性和模式（大调/小调）。

## 🎵 功能特点

### 核心功能
- ✅ **多种音频格式支持**：MP3、WAV、FLAC、AAC、OGG、WMA、M4A、Opus、AIFF
- ✅ **精确调性检测**：基于改进的Krumhansl-Schmuckler-Guo算法
- ✅ **置信度评分**：显示检测结果的可靠性
- ✅ **批量检测**：支持同时检测多个音频文件
- ✅ **自动格式处理**：librosa直接处理多种格式，无需额外转换

### GUI特性
- 🎨 **现代化界面**：简洁美观的图形用户界面
- 📊 **结果表格**：清晰展示检测结果，支持排序和查看
- 📈 **音频可视化**：实时显示音频波形图和频谱图
- ⚡ **进度反馈**：实时显示操作状态和进度

### 性能优化
- 🚀 **快速启动**：采用延迟加载技术，启动速度快
- 💡 **内存高效**：优化的资源管理，减少内存占用
- 📱 **流畅交互**：UI响应迅速，操作流畅

## 🔧 技术原理

1. **音频特征提取**：使用librosa库提取音频的音高类轮廓（Chroma Feature）
2. **多特征融合**：结合Chroma CQT和Chroma STFT两种特征提取方法
3. **模板匹配**：与Krumhansl-Schmuckler-Guo大小调模板进行相关性分析
4. **置信度计算**：综合多种特征的相关性结果，计算最终置信度
5. **结果优化**：对检测结果进行归一化和优化

## 📦 安装依赖

```bash
# 使用国内镜像源（推荐）
python -m pip install -r requirements.txt -i https://pypi.tuna.tsinghua.edu.cn/simple/

# 或使用默认源
python -m pip install -r requirements.txt
```

## 🚀 快速开始

### 运行程序


程序会直接启动GUI界面，无需任何命令行参数。

### 使用指南

1. **单文件检测**：
   - 点击「📁 选择单个音频文件」按钮
   - 选择要检测的音频文件
   - 检测结果会显示在下方表格中
   - 自动显示音频波形图

2. **批量检测**：
   - 点击「📂 选择多个音频文件」按钮
   - 选择多个要检测的音频文件
   - 点击「⚡ 开始批处理」按钮
   - 等待检测完成，结果会显示在表格中

3. **查看可视化**：
   - 检测完成后，点击「🎵 显示波形」查看波形图
   - 点击「📊 显示频谱」查看频谱图

4. **清空结果**：
   - 点击「🗑️ 清空检测结果」按钮
   - 所有结果和选择会被重置

## 📋 界面说明

### 控制面板
- **📁 选择单个音频文件**：选择并检测单个音频
- **📂 选择多个音频文件**：批量选择音频文件
- **⚡ 开始批处理**：启动批量检测
- **🗑️ 清空检测结果**：重置所有结果
- **状态标签**：显示当前操作状态
- **进度条**：显示操作进度
- **文件计数**：显示已选择的文件数量

### 检测结果表格
- **文件名**：显示音频文件名
- **调性**：显示检测到的调性（如C、D#等）
- **模式**：显示大调/小调
- **置信度**：显示检测结果的可靠性（0-1之间）

### 音频可视化
- **🎵 显示波形**：绘制音频波形图
- **📊 显示频谱**：绘制音频频谱图
- 支持缩放和拖动查看

## 🎯 检测结果解读

| 字段 | 说明 | 示例 |
|------|------|------|
| 调性 | 歌曲的主音 | C, G#, A |
| 模式 | 大调/小调 | major, minor |
| 置信度 | 检测结果的可靠性 | 0.8567（85.67%） |

### 置信度参考
- **> 0.8**：非常可靠
- **0.6 - 0.8**：可靠
- **0.4 - 0.6**：中等可靠
- **< 0.4**：可靠性较低

## 📝 注意事项

1. **推荐使用高质量音频**：无损格式（WAV、FLAC）能获得更准确的结果
2. **合理选择音频片段**：工具会自动截取前30秒进行分析
3. **大型文件处理**：较长的音频文件可能需要稍长的处理时间
4. **网络连接**：首次运行可能需要下载librosa的模型文件
5. **系统要求**：建议使用Python 3.8+，64位系统

## 🛠️ 依赖库

| 库名 | 版本 | 用途 |
|------|------|------|
| librosa | 0.11.0+ | 音频分析和特征提取 |
| numpy | 2.0+ | 数值计算和数组操作 |
| tkinter | 内置 | GUI界面开发 |
| pydub | 0.24.1+ | 音频处理支持 |
| matplotlib | 3.10.0+ | 音频可视化 |
| scipy | 1.17.0+ | 信号处理 |
| sounddevice | 0.5.3+ | 音频播放支持 |

## 🔄 更新日志

### v1.0（最新版）
- ✨ 全新GUI界面设计
- 📊 音频可视化功能
- ⚡ 批量检测支持
- 🚀 启动速度优化
- 🎨 现代化UI设计
- 📈 进度条和状态显示


## 📄 许可证

MIT License

## 🤝 贡献

欢迎提交Issue和Pull Request来帮助改进这个工具！

## 📧 联系方式

如有问题或建议，欢迎通过以下方式联系：
- 发送邮件至：your-email@example.com

## 🙏 致谢

- 感谢librosa团队提供的优秀音频分析库
- 感谢matplotlib团队提供的可视化支持
- 感谢所有为开源社区做出贡献的开发者

---

**享受音乐的乐趣！** 🎶